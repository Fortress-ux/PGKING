$(()=>{window.initializeRegisterInfo=n=>{$("#birthday_input").datepicker({changeYear:!0,changeMonth:!0,dateFormat:"yy-mm-dd",yearRange:"-100:+0"});const f=document.querySelector("#copy_phone_button"),s=document.querySelector("#Phone");f&&(f.onclick=()=>{navigator.clipboard&&navigator.clipboard.writeText(s.value.replaceAll("-","")).then(()=>registerPopup({content:n.translations.copied})).catch(n=>console.log("Error when copying phone number: "+n))});const e=document.querySelectorAll(".password_input_trigger");e.length&&e.forEach(n=>{const t=n.parentNode.querySelector("input[type=password]");n.onclick=()=>{if(t.type==="password"){t.type="text";return}t.type="password"}});const h=document.querySelectorAll(".form_subcategory");h.forEach(n=>{n.childElementCount<1&&(n.parentNode.style.display="none")});const t=document.querySelector("#selected_bank_select");if(t&&t.required!==!0){const n=document.querySelector("#bank_account_name_input"),i=document.querySelector("#bank_account_number_input");t.onchange=()=>{n.required=!!t.value,i.required=!!t.value}}const i=document.querySelector("#selected_emoney_select");if(i&&i.required!==!0){const n=document.querySelector("#emoney_account_name_input"),t=document.querySelector("#emoney_account_number_input");i.onchange=()=>{n.required=!!i.value,t.required=!!i.value}}const o=document.querySelector(".register_message");o&&registerPopup({content:o.innerText});const r=document.querySelector("#bank_account_section"),u=document.querySelector("#emoney_account_section");if(r&&u){const n=r.querySelectorAll('input[name="bank_section_radio_group"]'),t=u.querySelectorAll('input[name="emoney_section_radio_group"]');[...n,...t].forEach(i=>{i.onclick=()=>{r.hidden=i.value!=="bank",u.hidden=i.value!=="emoney",n.forEach(n=>n.checked=n.value===i.value),t.forEach(n=>n.checked=n.value===i.value)}});n[0].click()}const c=document.querySelector('form[data-ajax="true"]');if(c){const n=document.querySelector("#register_alert"),t=document.querySelector("#register_success_alert");n.hidden=!0;t.hidden=!0;const i=document.querySelector("#referral_code_checkbox");if(i){const n=document.querySelector("#referral_code_input");i.onchange=()=>{i.checked?(n.classList.add("show"),n.disabled=!1):(n.classList.remove("show"),n.disabled=!0)};i.onchange()}window.onRegisterAjaxRequestSuccess=i=>{if(n.hidden=!0,t.hidden=!0,registerPopup({content:i.message}),i.status!==!0){n.innerText=i.message;n.hidden=!1;return}t.innerText=i.message;t.hidden=!1;window.location.href=i.externalUrl;setTimeout(()=>{const n=document.querySelectorAll(".btn-primary");$(n).prop("disabled",!0)})}}}});
$(()=>{const n=document.querySelector("#request_registration_otp_button");if(n){const i=document.querySelector("#registration_otp_type_select"),t=document.querySelector("#registration_otp_contact_input");n.onclick=r=>{r.preventDefault();const u=t.value.trim();if(t.classList.remove("input-validation-error"),u.length===0){t.classList.add("input-validation-error");return}n.disabled=!0;window.$.ajax({type:"POST",url:"/register/otp/request",data:JSON.stringify({username:u,channelType:i.value}),contentType:"application/json; charset=utf-8",dataType:"json",success:t=>{if(isNaN(t.expiryInSeconds)||t.expiryInSeconds<=0){n.innerText=t.message;const i=parseInt(n.dataset.intervalInSeconds)*1e3||3e4;setTimeout(()=>{n.disabled=!1,n.innerText=n.dataset.title},i);return}let i=t.expiryInSeconds+1;const u=n=>Math.floor(n/60).toString().padStart(2,"0")+":"+Math.floor(n%60).toString().padStart(2,"0"),r=function(){if(i-=1,i<0){n.disabled=!1;n.innerText=n.dataset.title;return}n.innerText=t.message+` [${u(i)}]`;setTimeout(r,1e3)};r()}})}}});