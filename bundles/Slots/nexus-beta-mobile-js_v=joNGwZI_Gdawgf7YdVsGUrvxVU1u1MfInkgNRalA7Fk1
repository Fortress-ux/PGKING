$(()=>{const n=document.getElementById("game_list"),t=()=>{n&&(n.onclick=n=>{if(n.target.className==="favourite-game-btn"){let t="";t=n.target.checked?"/game/new-favourite":"/game/remove-favourite";$.ajax({type:"POST",data:JSON.stringify({Provider:n.target.dataset.provider,GameCode:n.target.value}),url:t,contentType:"application/json; charset=utf-8",dataType:"json",success:t=>{t.errorCode!=0&&(n.target.checked=!n.target.checked,registerPopup({content:`Unable to update favourite game. ${t.message}`}))},error:()=>{n.target.checked=!n.target.checked,registerPopup({content:"Unable to update favourite game."})}})}})};t()});
$(()=>{const n=document.querySelector("#filter_categories"),t=document.querySelector("#filter_input"),i=document.querySelector("#game_list"),r=document.querySelector("#game_modal"),f=document.querySelector("#game_modal_image"),e=document.querySelector("#game_modal_name"),u=document.querySelector("#game_modal_links");window.initializeSlotGames=o=>{$.ajax({type:"GET",url:`/mobile/slots/games/${o.provider}`,contentType:"application/json; charset=utf-8",dataType:"json",success:s=>{const h=84,c=89,a=new Set,y=document.createDocumentFragment();s.forEach(n=>{n.categories.forEach(n=>a.add(n.name));const l=document.createElement("img");l.src=`${o.directoryPath}${o.provider}/${n.gameImage}`;l.alt=n.name;const i=document.createElement("div");if(i.className="wrapper-container",i.appendChild(l),n.rtpChanged!==null&&isFinite(n.rtpChanged.from)&&isFinite(n.rtpChanged.to)){const f=document.createElement("span");f.className="rtp-title";f.innerText="RTP";const t=document.createElement("div"),e=n.rtpChanged.from.toFixed(2),s=n.rtpChanged.to.toFixed(2);t.className="rtp-progress-bar";t.dataset.rtpFrom=e;t.dataset.rtpTo=s;t.style.width=e+"%";t.style.setProperty("--from-value",`${e}%`);t.style.setProperty("--to-value",`${s}%`);n.rtpChanged.from<h&&t.style.setProperty("--from-color","var(--low)");n.rtpChanged.from>=h&&n.rtpChanged.from<=c&&t.style.setProperty("--from-color","var(--medium)");n.rtpChanged.from>c&&t.style.setProperty("--from-color","var(--high)");n.rtpChanged.to<h&&t.style.setProperty("--to-color","var(--low)");n.rtpChanged.to>=h&&n.rtpChanged.to<=c&&t.style.setProperty("--to-color","var(--medium)");n.rtpChanged.to>c&&t.style.setProperty("--to-color","var(--high)");t.dataset.rtpFrom!="medium"&&t.dataset.rtpTo!="medium"?t.style.setProperty("--transition-color","var(--medium)"):t.style.setProperty("--transition-color","var(--from-color)");const o=document.createElement("div");o.className="rtp-progress";o.appendChild(t);const u=document.createElement("span");u.className="rtp-percentage";u.dataset.rtpFrom=Math.ceil(n.rtpChanged.from);u.dataset.rtpTo=Math.ceil(n.rtpChanged.to);const r=document.createElement("div");r.className="rtp-container";r.appendChild(f);r.appendChild(o);r.appendChild(u);i.appendChild(r)}else if(n.rtpValue!==null&&isFinite(n.rtpValue)){const u=document.createElement("span");u.className="rtp-title";u.innerText="RTP";const t=document.createElement("div");t.className="rtp-progress-bar";t.style.width=n.rtpValue.toFixed(2)+"%";n.rtpValue<h&&(t.dataset.rtp="low");n.rtpValue>=h&&n.rtpValue<=c&&(t.dataset.rtp="medium");n.rtpValue>c&&(t.dataset.rtp="high");const f=document.createElement("div");f.className="rtp-progress";f.appendChild(t);const e=document.createElement("span");e.className="rtp-percentage";e.innerHTML=Math.ceil(n.rtpValue)+"%";const r=document.createElement("div");r.className="rtp-container";r.appendChild(u);r.appendChild(f);r.appendChild(e);i.appendChild(r)}const s=document.createElement("div");s.className="game-name-container";const v=document.createElement("div");v.className="game-name";v.innerText=n.name;s.appendChild(v);const t=document.createElement("li");if(t.className="game-item",t.dataset.game=n.name,t._categories=n.categories.filter(n=>n.seqNo>=0),n.isFavourite!==undefined&&n.isFavourite!==null){const i=document.createElement("input");i.type="checkbox";i.dataset.provider=o.provider;i.value=n.gameCode;i.id=n.gameCode;i.className="favourite-game-btn";n.isFavourite&&(i.checked=!0);const r=document.createElement("label");r.htmlFor=n.gameCode;o.altFavouriteBtnPosition?(s.appendChild(i),s.appendChild(r)):(t.appendChild(i),t.appendChild(r))}if(r)i.onclick=()=>{f.src=l.src;e.innerText=n.name;const i=document.createDocumentFragment();if(o.onDemoLinkClicked){const t=document.createElement("a");t.className="free-play";t.innerText=o.translations.demo;t.onclick=()=>o.onDemoLinkClicked(n.gameCode);i.appendChild(t)}const t=document.createElement("a");t.className="play-now";t.dataset.game=n.name;t.href=n.link;t.innerText=o.translations.playNow;i.appendChild(t);u.innerHTML="";u.appendChild(i);$(r).modal()},t.appendChild(i),t.appendChild(s);else{const f=document.createElement("span");if(f.className="link-container",o.onDemoLinkClicked){const t=document.createElement("a");t.className="free-play";t.innerText=o.translations.demo;t.onclick=()=>o.onDemoLinkClicked(n.gameCode);f.appendChild(t)}i.appendChild(f);const r=document.createElement("a");r.className="play-now";r.dataset.game=n.name;r.href=n.link;r.innerText=o.translations.playNow;f.appendChild(r);const e=document.createElement("input");e.type="radio";e.name="game-list-radio-button";const u=document.createElement("label");u.className="inner-game-item";u.appendChild(e);u.appendChild(i);u.appendChild(v);t.appendChild(u)}y.appendChild(t)});i.appendChild(y);const p=document.createDocumentFragment();a.forEach(t=>{if(t==="DEFAULT"){const i=n.querySelector('[data-category=""]');i.dataset.category=t;return}const i=document.createElement("div");i.className="category-filter-link";i.dataset.category=t;i.innerText=t;p.appendChild(i)});n.appendChild(p);const k=i.querySelectorAll(".game-item"),l={name:null,category:null},w=()=>{Array.prototype.slice.call(k).forEach(n=>{const i=n.dataset.game.toLowerCase(),t=n._categories.find(n=>n.name===l.category),r=!l.category||t!==undefined,u=!l.name||i.indexOf(l.name)>=0;r&&u?(n.style.order=t&&t.seqNo||0,$(n).show()):(n.style.order=0,$(n).hide())})};$(t).keyup(function(){l.name=t.value.toLowerCase();w()});$(n).on("click",".category-filter-link",function(){const n=$(this);n.siblings().removeClass("active");n.addClass("active");l.category=this.dataset.category;w()});const b=new URLSearchParams(window.location.search).get("PromotionCategory");if(b){const t=Array.from(a).find(n=>n.toLowerCase()===b.toLowerCase());if(t){n.querySelector(`[data-category="${t}"]`).click();return}}const v=n.querySelector(".active");v&&v.dataset.category!==""&&v.click()}})}});